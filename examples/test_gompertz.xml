<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="
    beast.core:
    beast.evolution.alignment:
    beast.evolution.tree.coalescent:
    beast.core.util:
    beast.evolution.nuc:
    beast.evolution.operators:
    beast.evolution.sitemodel:
    beast.evolution.substitutionmodel:
    beast.base.evolution.alignment:
    beast.pkgmgmt:
    beast.base.core:
    beast.base.inference:
    beast.base.evolution.tree.coalescent:
    beast.pkgmgmt:
    beast.base.inference.util:
    beast.base.evolution.operator:
    beast.base.inference.operator:
    beast.base.evolution.sitemodel:
    beast.base.evolution.substitutionmodel:
    beast.base.evolution.likelihood"
       version="2.7">

    <!-- The sequence alignment (each sequence refers to a taxon above).         -->
    <!-- ntax=6 nchar=768                                                        -->
    <!-- npatterns=69                                                            -->
    <data id="alignment" dataType="nucleotide">
        <sequence taxon="human">
            AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGGAGCTTAAACCCCCTTATTTCTACTAGGACTATGAGAATCGAACCCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTATACCCTTCCCGTACTAAGAAATTTAGGTTAAATACAGACCAAGAGCCTTCAAAGCCCTCAGTAAGTTG-CAATACTTAATTTCTGTAAGGACTGCAAAACCCCACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGACCAATGGGACTTAAACCCACAAACACTTAGTTAACAGCTAAGCACCCTAATCAAC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTCGAATTTGCAATTCAATATGAAAA-TCACCTCGGAGCTTGGTAAAAAGAGGCCTAACCCCTGTCTTTAGATTTACAGTCCAATGCTTCA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCCAAAGCTGGTTTCAAGCCAACCCCATGGCCTCCATGACTTTTTCAAAAGGTATTAGAAAAACCATTTCATAACTTTGTCAAAGTTAAATTATAGGCT-AAATCCTATATATCTTA-CACTGTAAAGCTAACTTAGCATTAACCTTTTAAGTTAAAGATTAAGAGAACCAACACCTCTTTACAGTGA
        </sequence>
        <sequence taxon="chimp">
            AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGTTCAAATCCCCTTATTTCTACTAGGACTATAAGAATCGAACTCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTACACCCTTCCCGTACTAAGAAATTTAGGTTAAGCACAGACCAAGAGCCTTCAAAGCCCTCAGCAAGTTA-CAATACTTAATTTCTGTAAGGACTGCAAAACCCCACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATTAATGGGACTTAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAATCAAC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTCGAATTTGCAATTCAATATGAAAA-TCACCTCAGAGCTTGGTAAAAAGAGGCTTAACCCCTGTCTTTAGATTTACAGTCCAATGCTTCA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCTAAAGCTGGTTTCAAGCCAACCCCATGACCTCCATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAAGTTAAATTACAGGTT-AACCCCCGTATATCTTA-CACTGTAAAGCTAACCTAGCATTAACCTTTTAAGTTAAAGATTAAGAGGACCGACACCTCTTTACAGTGA
        </sequence>
        <sequence taxon="bonobo">
            AGAAATATGTCTGATAAAAGAATTACTTTGATAGAGTAAATAATAGGAGTTTAAATCCCCTTATTTCTACTAGGACTATGAGAGTCGAACCCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTATACCCTTCCCGTACTAAGAAATTTAGGTTAAACACAGACCAAGAGCCTTCAAAGCTCTCAGTAAGTTA-CAATACTTAATTTCTGTAAGGACTGCAAAACCCCACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATTAATGGGACTTAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAATCAGC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTTGAATTTGCAATTCAATATGAAAA-TCACCTCAGAGCTTGGTAAAAAGAGGCTTAACCCCTGTCTTTAGATTTACAGTCCAATGCTTCA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCTAAAGCTGGTTTCAAGCCAACCCCATGACCCCCATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAAGTTAAATTACAGGTT-AAACCCCGTATATCTTA-CACTGTAAAGCTAACCTAGCATTAACCTTTTAAGTTAAAGATTAAGAGGACCAACACCTCTTTACAGTGA
        </sequence>
        <sequence taxon="gorilla">
            AGAAATATGTCTGATAAAAGAGTTACTTTGATAGAGTAAATAATAGAGGTTTAAACCCCCTTATTTCTACTAGGACTATGAGAATTGAACCCATCCCTGAGAATCCAAAATTCTCCGTGCCACCTGTCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTCACATCCTTCCCGTACTAAGAAATTTAGGTTAAACATAGACCAAGAGCCTTCAAAGCCCTTAGTAAGTTA-CAACACTTAATTTCTGTAAGGACTGCAAAACCCTACTCTGCATCAACTGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATCAATGGGACTCAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAGTCAAC-TGGCTTCAATCTAAAGCCCCGGCAGG-TTTGAAGCTGCTTCTTCGAATTTGCAATTCAATATGAAAT-TCACCTCGGAGCTTGGTAAAAAGAGGCCCAGCCTCTGTCTTTAGATTTACAGTCCAATGCCTTA-CTCAGCCATTTTACCACAAAAAAGGAAGGAATCGAACCCCCCAAAGCTGGTTTCAAGCCAACCCCATGACCTTCATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAGGTTAAATTACGGGTT-AAACCCCGTATATCTTA-CACTGTAAAGCTAACCTAGCGTTAACCTTTTAAGTTAAAGATTAAGAGTATCGGCACCTCTTTGCAGTGA
        </sequence>
        <sequence taxon="orangutan">
            AGAAATATGTCTGACAAAAGAGTTACTTTGATAGAGTAAAAAATAGAGGTCTAAATCCCCTTATTTCTACTAGGACTATGGGAATTGAACCCACCCCTGAGAATCCAAAATTCTCCGTGCCACCCATCACACCCCATCCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTACACCCTTCCCGTACTAAGAAATTTAGGTTA--CACAGACCAAGAGCCTTCAAAGCCCTCAGCAAGTCA-CAGCACTTAATTTCTGTAAGGACTGCAAAACCCCACTTTGCATCAACTGAGCGCAAATCAGCCACTTTAATTAAGCTAAGCCCTCCTAGACCGATGGGACTTAAACCCACAAACATTTAGTTAACAGCTAAACACCCTAGTCAAT-TGGCTTCAGTCCAAAGCCCCGGCAGGCCTTAAAGCTGCTCCTTCGAATTTGCAATTCAACATGACAA-TCACCTCAGGGCTTGGTAAAAAGAGGTCTGACCCCTGTTCTTAGATTTACAGCCTAATGCCTTAACTCGGCCATTTTACCGCAAAAAAGGAAGGAATCGAACCTCCTAAAGCTGGTTTCAAGCCAACCCCATAACCCCCATGACTTTTTCAAAAGGTACTAGAAAAACCATTTCGTAACTTTGTCAAAGTTAAATTACAGGTC-AGACCCTGTGTATCTTA-CATTGCAAAGCTAACCTAGCATTAACCTTTTAAGTTAAAGACTAAGAGAACCAGCCTCTCTTTGCAATGA
        </sequence>
        <sequence taxon="siamang">
            AGAAATACGTCTGACGAAAGAGTTACTTTGATAGAGTAAATAACAGGGGTTTAAATCCCCTTATTTCTACTAGAACCATAGGAGTCGAACCCATCCTTGAGAATCCAAAACTCTCCGTGCCACCCGTCGCACCCTGTTCTAAGTAAGGTCAGCTAAATAAGCTATCGGGCCCATACCCCGAAAATGTTGGTTATACCCTTCCCATACTAAGAAATTTAGGTTAAACACAGACCAAGAGCCTTCAAAGCCCTCAGTAAGTTAACAAAACTTAATTTCTGCAAGGGCTGCAAAACCCTACTTTGCATCAACCGAACGCAAATCAGCCACTTTAATTAAGCTAAGCCCTTCTAGATCGATGGGACTTAAACCCATAAAAATTTAGTTAACAGCTAAACACCCTAAACAACCTGGCTTCAATCTAAAGCCCCGGCAGA-GTTGAAGCTGCTTCTTTGAACTTGCAATTCAACGTGAAAAATCACTTCGGAGCTTGGCAAAAAGAGGTTTCACCTCTGTCCTTAGATTTACAGTCTAATGCTTTA-CTCAGCCACTTTACCACAAAAAAGGAAGGAATCGAACCCTCTAAAACCGGTTTCAAGCCAGCCCCATAACCTTTATGACTTTTTCAAAAGATATTAGAAAAACTATTTCATAACTTTGTCAAAGTTAAATCACAGGTCCAAACCCCGTATATCTTATCACTGTAGAGCTAGACCAGCATTAACCTTTTAAGTTAAAGACTAAGAGAACTACCGCCTCTTTACAGTGA
        </sequence>
    </data>

    <!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
    <input spec='HKY' id="hky">
        <parameter name='kappa' idref='hky.kappa'/>
        <input id='freqs' name='frequencies' spec='Frequencies' frequencies='@hky.frequencies'/>
    </input>

    <!-- site model                                                              -->
    <input spec='SiteModel' id="siteModel">
        <!--<parameter name='mutationRate'>1.0</parameter>-->
        <substModel idref='hky'/>
    </input>

    <input spec='TreeLikelihood' id="treeLikelihood">
        <data idref="alignment"/>
        <tree idref="tree"/>
        <siteModel idref="siteModel"/>
    </input>


    <input spec='beast.base.evolution.tree.ClusterTree' id='tree' clusterType='upgma'>
        <taxa idref='alignment'/>
    </input>

    <parameter id="hky.kappa" value="2.0" lower="0.0"/>
    <parameter id="hky.frequencies" value="0.25" dimension="4" lower='0.0'/>
    <parameter id="f0" name="stateNode" value="0.5" lower="0.0" upper="1.0"/>
    <parameter id="N0" name="stateNode" value="1e11" lower="0.0" upper="Infinity"/>
    <parameter id="b" name="stateNode" value="0.1" lower="-Infinity" upper="Infinity"/>
    <!--    <parameter id="popSize" value="0.077" lower="0.0"/>-->
    <!--    <parameter id="growthRate" value="7.7E-5"/>-->


    <run spec="MCMC" id="mcmc" chainLength="10000000"> <!--autoOptimize="true"-->
        <state>
            <!--
                        <tree spec='util.TreeParser' id='tree'>
                            <input name='newick'>((5:0.04847887618847128,(3:0.03189934232093919,((2:0.011076861832266626,1:0.011076861832266626):0.009810542752873795,4:0.02088740458514042):0.011011937735798769):0.01657953386753209):0.017232517763959114,6:0.06571139395243039);</input>
                           <input name='taxa' idref='alignment'/>
                        </tree>
            -->

            <input name='stateNode' idref='hky.kappa'/>
            <input name='stateNode' idref='hky.frequencies' />
            <input name='stateNode' idref='f0' />
            <input name='stateNode' idref='N0' />
            <input name='stateNode' idref='b' />
            <input name='stateNode' idref='tree'/>
        </state>

        <distribution spec="CompoundDistribution" id="posterior">
            <distribution spec="CompoundDistribution" id="prior">
                <distribution id="hky.kappa.prior" spec="beast.base.inference.distribution.Prior" x="@hky.kappa">
                    <distr id="LogNormalDistributionModel" M="1.0" S="1.25" meanInRealSpace="false"
                           spec="beast.base.inference.distribution.LogNormalDistributionModel"/>

                </distribution>
                <distribution id="hky.frequencies.prior" spec="beast.base.inference.distribution.Prior" x="@hky.frequencies">
                    <distr id="Uniform" lower="0.0" upper="1.0" spec="beast.base.inference.distribution.Uniform"/>
                </distribution>

                <distribution id="f0.prior" spec="beast.base.inference.distribution.Prior" x="@f0">
                    <distr spec="beast.base.inference.distribution.Beta" alpha="20.0" beta="2.0"/>
                </distribution>
<!--                <distribution id="N0.prior" spec="beast.base.inference.distribution.Prior" x="@N0">-->
<!--                    <distr spec="beast.base.inference.distribution.Normal" mean="1e11" sigma="50.0"/>-->
                <distribution id="N0.prior" spec="beast.base.inference.distribution.Prior" x="@N0">
                    <distr spec="beast.base.inference.distribution.LogNormalDistributionModel" meanInRealSpace="true">
                        <parameter name="M" value="11"/> <!-- log(1e11) to convert mean to log-scale -->
                        <parameter name="S" value="0.2"/>
                    </distr>
                </distribution>
                <distribution id="b.prior" spec="beast.base.inference.distribution.Prior" x="@b">
                    <distr spec='beast.base.inference.distribution.LogNormalDistributionModel' M="-0.415" S="0.71" meanInRealSpace="false"/>
                </distribution>

                <distribution id="coalescent" spec="Coalescent">
                    <treeIntervals spec='beast.base.evolution.tree.TreeIntervals' id='TreeIntervals'>
                        <tree idref="tree"/>
                    </treeIntervals>
                    <populationModel id="gompertzPopulationModel" spec="phylonco.beast.evolution.populationmodel.GompertzGrowth_f0">
                        <parameter name="f0" idref="f0"/>
                        <parameter name="N0" idref="N0"/>
                        <parameter name="b" idref="b"/>
                    </populationModel>
                </distribution>
            </distribution>
            <distribution id='likelihood' idref="treeLikelihood"/>
        </distribution>

        <operator id='f0Scaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@f0"/>
        <operator id='N0Scaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@N0"/>
        <operator id='bRandomWalk' spec='RealRandomWalkOperator' windowSize="0.1" weight="0.1" parameter="@b"/>

        <operator id='kappaScaler' spec='ScaleOperator' scaleFactor="0.75" weight="0.1" parameter="@hky.kappa"/>
        <operator id='frequenciesDelta' spec='DeltaExchangeOperator' delta="0.01" weight="0.1" parameter="@hky.frequencies"/>
        <operator id='treeScaler' spec='ScaleOperator' scaleFactor="0.75" weight="3" tree="@tree"/>
        <operator spec='Uniform' weight="30" tree="@tree"/>
        <operator spec='SubtreeSlide' weight="15" gaussian="true" size="0.0077" tree="@tree"/>
        <operator id='narrow' spec='Exchange' isNarrow='true' weight="15" tree="@tree"/>
        <operator id='wide' spec='Exchange' isNarrow='false' weight="3" tree="@tree"/>
        <operator spec='WilsonBalding' weight="1" tree="@tree"/>
        <operator spec='UpDownOperator' scaleFactor="0.75" weight="3" down="@tree"/>


        <logger logEvery="1000" fileName="test.$(seed).log">
            <log idref="posterior"/>
            <log idref="prior"/>
            <log spec='beast.base.evolution.tree.TreeHeightLogger' tree='@tree'/>
            <log idref="f0"/>
            <log idref="N0"/>
            <log idref="b"/>
            <log idref="hky.kappa"/>
            <log idref="hky.frequencies"/>
            <log idref="likelihood"/>
            <log idref="coalescent"/>
            <!-- Assuming 'gompertzPopulationModel' is your Gompertz population model id -->
            <log idref="gompertzPopulationModel"/>
        </logger>

        <!-- Uncomment and update this logger if you want to log trees
        <logger logEvery="1000" fileName="test.$(seed).trees">
            <log idref="tree"/>
        </logger>
        -->

        <logger logEvery="100000">
            <log idref="posterior"/>
            <log idref="prior"/>
            <log spec='beast.base.evolution.tree.TreeHeightLogger' tree='@tree'/>
            <log idref="f0"/>
            <log idref="N0"/>
            <log idref="b"/>
            <log idref="hky.kappa"/>
            <log idref="hky.frequencies"/>
            <log idref="likelihood"/>
            <log idref="coalescent"/>
            <log idref="gompertzPopulationModel"/>
        </logger>
    </run>
</beast>